# SA Explorer - Copilot Instructions

This project is a web-based analyzer for Star Atlas SAGE fleet fees and operations.

## Project Overview
- **Name**: SA Explorer
- **Purpose**: Analyze Star Atlas fleet operations and SAGE fees with detailed breakdowns
- **Tech Stack**: TypeScript, Node.js, Express.js, Star Atlas SAGE SDK
- **Architecture**: Express REST API server with vanilla JavaScript frontend

## Development Guidelines
- Use TypeScript for all backend source code (`src/`)
- Use vanilla JavaScript for frontend (`public/app.js`)
- Follow Star Atlas SAGE SDK patterns for blockchain interactions
- Implement proper error handling for Solana/blockchain operations
- Use modular architecture with separate modules in `src/examples/`
- Include comprehensive logging for debugging blockchain interactions
- Support both owned and rented fleet detection via SRSLY program

## Key Features Implemented
- **Fleet Discovery**: Automatic detection of owned and rented fleets (SRSLY integration)
- **SAGE Fee Analysis**: 24-hour fee breakdown by fleet and operation type
- **Rental Detection**: Multi-strategy rental detection (SRSLY scan, subProfile, transactions)
- **Visual Reports**: Pie charts and detailed fleet breakdowns
- **Operation Tracking**: Comprehensive SAGE operation mapping and categorization
- **Rented Fleet Highlighting**: Visual distinction with yellow bold names, badges, and sorting

## Dependencies
- @staratlas/sage - Star Atlas game SDK
- @staratlas/data-source - Data source utilities
- @staratlas/player-profile - Player profile management
- @solana/web3.js - Solana blockchain interaction
- @project-serum/anchor - Solana program framework
- express - Web server framework
- typescript - Type safety and development

## File Structure
- `src/` - TypeScript source code
	- `index.ts` - Express server and API routes
	- `examples/` - SAGE interaction modules
		- `01-game.ts` - Game data
		- `02-profile.ts` - Player profile
		- `03-fleets.ts` - Fleet discovery (owned + SRSLY rentals)
		- `04-planets.ts` - Planet data
		- `05-compose-fleet.ts` - Fleet composition
		- `06-transactions.ts` - Transaction analysis and fee calculation
	- `utils/` - Helper utilities
- `public/` - Frontend static assets
	- `index.html` - Main UI
	- `app.js` - Frontend logic
	- `styles.css` - UI styling
- `dist/` - Compiled JavaScript output (generated by `tsc`)

## Important Context
- **SAGE Program**: SAGE2HAwep459SNq61LHvjxPk4pLPEJLoMETef7f7EE
- **SRSLY Rentals Program**: SRSLY1fq9TJqCk1gNSE7VZL2bztvTn9wm4VR8u8jMKT
- **Fleet Account Structure**: 536 bytes, owningProfile at offset 41, subProfile at offset 73
- **Rental Detection**: Uses SRSLY program scan + subProfile checks + transaction analysis
- **RPC Endpoint**: Helius mainnet RPC (configured in src/index.ts)